var Jerboa=(function(i){i.lib={};i.lib.env={ie:/MSIE/i.test(navigator.userAgent),ie6:/MSIE 6/i.test(navigator.userAgent),ie7:/MSIE 7/i.test(navigator.userAgent),ie8:/MSIE 8/i.test(navigator.userAgent),firefox:/Firefox/i.test(navigator.userAgent),opera:/Opera/i.test(navigator.userAgent),webkit:/Webkit/i.test(navigator.userAgent),camino:/Camino/i.test(navigator.userAgent)};i.lib.onDomReady=function(a){if(document.addEventListener){document.addEventListener("DOMContentLoaded",a,false)}else{if(document.body&&document.body.lastChild){a()}else{var b=arguments.callee;setTimeout(function(){b(a)},50)}}};i.lib.addEvent=function(a,b,d){b=b.toLowerCase();if(a.addEventListener){a.addEventListener(b,d,false)}else if(a.attachEvent){a.attachEvent("on"+b,d)}};i.lib.removeEvent=function(a,b,d){b=b.toLowerCase();if(a.removeEventListener){a.removeEventListener(b,d,false)}else if(a.detachEvent){a.detachEvent("on"+b,d)}};i.lib.getEvent=function(a){if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}return{target:this.getTargetFromEvent(a),preventDefault:function(){if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}}}};i.lib.getTargetFromEvent=function(a){var b=a.srcElement||a.target;if(b.nodeType==3){b=b.parentNode}return b};i.lib.getArrayOfClassNames=function(a){var b=[];if(a.className){b=a.className.split(" ")}return b};i.lib.addClass=function(a,b){var d=this.getArrayOfClassNames(a);d.push(b);a.className=d.join(" ")};i.lib.removeClass=function(a,b){var d=this.getArrayOfClassNames(a);var c=[];for(var g=0;g<d.length;g++){if(b!=d[g]){c.push(d[g])}}a.className=c.join(" ")};i.lib.hasClass=function(a,b){var d=false;var c=this.getArrayOfClassNames(a);for(var g=0;g<c.length;g++){if(b==c[g]){d=true}}return d};i.lib.getObjectOfStyle=function(a){var b=a.getAttribute("style")||"",d=0,c=0,g={},f="";if(b){b=b.split(";");for(d=0,c=b.length;d<c;d++){if(b[d]){f=b[d].split(":");if(f.length==2){f[0]=f[0].replace(/^[\s]+/g,"");f[1]=f[1].replace(/^[\s]+/g,"");f[0]=f[0].replace(/[\s]+$/g,"");f[1]=f[1].replace(/[\s]+$/g,"");g[f[0]]=f[1]}}}}return g};i.lib.setObjectOfStyle=function(a,b){var d="",c;for(c in b){d=d.concat(c+":"+b[c]+";")}a.setAttribute("style",d)};i.lib.addStyle=function(a,b){var d=this.getObjectOfStyle(a),c;for(c in b){d[c]=b[c]}this.setObjectOfStyle(a,d)};i.lib.removeStyle=function(a,b){var d=this.getObjectOfStyle(a),c,g;for(c=0,g=b.length;c<g;c++){if(d[b[c]]){delete d[b[c]]}}this.setObjectOfStyle(a,d)};i.lib.setNode=function(a,b){if(arguments.length==0){return document.createElement("div")}if(arguments.length==1){b=arguments[0];a=document.createElement(b.tag||b.Tag||"div")}var d=b.Attr||b.attr||{},c=b.event||b.Event||{};if(c.add){this.addEvent(a,c.add,c.fn)}else if(c.remove){this.removeEvent(a,c.remove,c.fn)}for(var g in d){a.setAttribute(g,d[g])}if(b.html)a.innerHTML=b.html;return a};i.lib.request=function(a){var b=null,d=(a.method)?a.method.toUpperCase():"GET",c=a.url,g="",f="";delete a.method;delete a.url;if(window.XMLHttpRequest){b=new XMLHttpRequest()}else{b=new ActiveXObject("Microsoft.XMLHTTP")}for(g in a){f+=g+"="+a[g]+"&"}f=f.substr(0,f.length-1);if(d=="GET"){if(/\?/.test(c))c=c+"&"+f;else c=c+"?"+f}b.open(d,encodeURI(c),true);b.onreadystatechange=function(){if(b.readyState==4){if(b.status==200)console.log("Jerboa send complete");else console.log("Jerboa send fail")}};if(d=="POST"){b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.setRequestHeader("Content-length",f.split("&").length);b.setRequestHeader("Connection","close");b.send(encodeURI(f))}else b.send()};i.lib.detectMedia=function(a){var b={"p":1,"span":1,"div":1},d={"object":1,"embed":1,"video":1};if(typeof a==="object"){if(a.tagName.toLowerCase()=="img"){return"image"}else if(d[a.tagName.toLowerCase()]||a.getAttribute("class")=="jerboa-media-touch"){return"media"}else{return"text"}}else if(typeof a==="string"){if(/^\<img/i.test(a))return"image";else{for(var c in d){if((new RegExp("^\<"+c)).test(a))return"media"}}return"text"}}i.lib.curry=function(b,d,c){var d=d||window,g=Array.prototype.slice.call(arguments,3);if(c){return function(){var a=arguments;clearTimeout(b.tId);b.tId=setTimeout(function(){b.apply(d,g.concat(Array.prototype.slice.call(a,0)))},c)}}else return function(){b.apply(d,g.concat(Array.prototype.slice.call(arguments,0)))}};return i}(Jerboa||{}));var Jerboa=(function(l){var x=function(a,b){this.name=a;this.methods=[];for(var d=0,c=b.length;d<c;d++){if(typeof b[d]!=="string"){throw new Error("Interface Error: Method names should be string.");}this.methods.push(b[d])}};function A(a){if(arguments.length<2)throw new Error("hasImplement Error: Please use hasImplement(Object, Interface1 [, Interface2, ...])");for(var b=1,d=arguments.length,c,g;b<d;b++){var f=arguments[b];for(c=0,g=f.methods.length;c<g;c++){var i=f.methods[c];if(!a[i]){throw new Error("hasImplement Error: object did not implement "+f.name+" interface. Method "+i+" was not found.");}}}}function J(a,b){var d=function(){};d.prototype=b.prototype;a.prototype=new d();a.prototype.constructor=a}var B=function(b){var d,c={},b=b.toLowerCase();if(C[b]){throw new Error("Module "+b+" have been used");}d=e.setNode({attr:{id:"jerboa-"+b.toLowerCase(),"class":"jerboa-panel jerboa-ignore hide"}});C[b.toLowerCase()]=true;this.getElement=function(){return d}this.add=function(a){d.appendChild(a.getElement());c[a.name]=a;return d.children.length-1}this.remove=function(a){d.removeChild(this.getChild(a))}this.getChild=function(a){if(a)return c[a]}this.show=function(){if(e.hasClass(d,"hide"))e.removeClass(d,"hide")}this.hide=function(){if(!e.hasClass(d,"hide"))e.addClass(d,"hide")}};var E=function(){B.call(this,"menu");e.setNode(this.getElement(),{attr:{"class":"jerboa-panel jerboa-ignore"}})};J(E,B);var K=function(d){var c=d.substr(0,1).toUpperCase().concat(d.substr(1)),g=e.setNode({attr:{"class":"jerboa-ignore"},html:c});this.onClick=function(a){var b=e.getEvent(a);b.preventDefault();this.toggleMenu();n.notify("click-menu-"+this.name,a)}this.toggleMenu=function(){if(e.hasClass(g,"jerboa-panel-active"))e.removeClass(g,"jerboa-panel-active");else e.addClass(g,"jerboa-panel-active")}this.name=d.toLowerCase();this.getElement=function(){return g}this.show=function(){if(e.hasClass(g,"hide"))e.removeClass(g,"hide")}this.hide=function(){if(!e.hasClass(g,"hide"))e.addClass(g,"hide")}e.addEvent(g,"click",e.curry(this.onClick,this))}var L=function(M,y){var o=M,t=[],r,p={},D;e.addStyle(o,{"padding":"0"});if(o.children[0]&&o.children[0].className=="jerboa-ignore"){r=o.children[0];D=r.innerHTML}else{r=e.setNode({tag:"div",attr:{"class":"jerboa-ignore","style":"position:relative;top:0;left:0;width:100%;height:auto;overflow:hidden;"}});D=o.innerHTML;o.innerHTML="";o.appendChild(r)}if(r.children[0]&&e.hasClass(r.children[0],"jerboa-layer")){t.push(r.children[0])}else{t.push(e.setNode({attr:{"index":0,"class":"jerboa-layer jerboa-ignore","style":"z-index:2000;"},html:D}));r.appendChild(t[0])}p.top=e.setNode({attr:{"class":"jerboa-lightbox jerboa-ignore",style:""}});p.left=e.setNode({attr:{"class":"jerboa-lightbox jerboa-ignore",style:""}});p.right=e.setNode({attr:{"class":"jerboa-lightbox jerboa-ignore",style:""}});p.bottom=e.setNode({attr:{"class":"jerboa-lightbox jerboa-ignore",style:""}});y.core.appendChild(p.top);y.core.appendChild(p.right);y.core.appendChild(p.left);y.core.appendChild(p.bottom);this.currentEditingNode="";this.currentState="";this.getElement=function(){return o}this.getLayer=function(){return t[0]}this.refreshStage=function(){var a={x:o.offsetLeft,y:o.offsetTop,width:o.offsetWidth,height:o.offsetHeight},b={width:Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),height:Math.max(document.body.offsetHeight,document.documentElement.offsetHeight)};e.addStyle(p.top,{top:"0px",left:"0px",width:a.x+"px",height:b.height+"px"});e.addStyle(p.left,{top:"0px",left:a.x+"px",width:a.width+"px",height:a.y+"px"});e.addStyle(p.right,{top:"0px",left:parseInt(a.x+a.width)+"px",width:parseInt(b.width-a.x-a.width)+"px",height:b.height+"px"});e.addStyle(p.bottom,{top:parseInt(a.y+a.height)+"px",left:a.x+"px",width:a.width+"px",height:parseInt(b.height-a.y-a.height)+"px"})}this.setHeight=function(a){e.addStyle(r,{"height":a+"px"});this.refreshStage()}this.autoHeight=function(){var a=0,b;for(b=0,len=t[0].children.length;b<len;b++){a+=t[0].children[b].offsetHeight}console.log("Page height: "+a);this.setHeight((a>300)?a:300)}this.normalizeTree=function(a){if(!a)return"";var b=[],d=[],c,g,f,i=true,h,m=a.cloneNode(true);b.push(m);d.push(a);while(b.length>0){f=b.shift();currentNode2=d.shift();if(!f.children)continue;for(c=0,g=f.children.length;c<g;c++){switch(e.detectMedia(f.children[c])){case"image":if(!i&&f.children.length==1){h=f;while(h.children.length==1&&!e.hasClass(h.parentNode,"jerboa-ignore")){h=h.parentNode}h.setAttribute("role","image");h.appendChild(f.children[c].cloneNode(true));h.removeChild(h.firstChild);continue}else{h=f.children[c].cloneNode(true);h=e.setNode({tag:"div",attr:{"role":"image","style":"position:absolute;"}}).appendChild(h).parentNode;m.appendChild(h);f.removeChild(f.children[c]);delete h}break;case"media":if(!i&&f.children.length==1){h=f;while(h.children.length==1&&!e.hasClass(h.parentNode,"jerboa-ignore")){h=h.parentNode}h.setAttribute("role","media");h.appendChild(e.setNode({tag:"div",attr:{"class":"jerboa-media-touch"},html:"\&\#160\;"}));h.appendChild(f.children[c].cloneNode(true));h.removeChild(h.firstChild);if(h.children[1].tagName.toLowerCase()=="object"){h.children[1].insertBefore(e.setNode({tag:"param",attr:{"name":"wmode","value":"opaque"}}),h.children[1].children[0]);h.children[1].lastChild.setAttribute("wmode","opaque")}continue}else{h=f.children[c].cloneNode(true);h=e.setNode({tag:"div",attr:{"role":"media","style":"position:absolute;"},html:"<div class=\"jerboa-media-touch\">\&\#160\;</div>"}).appendChild(h).parentNode;if(h.children[1].tagName.toLowerCase()=="object"){h.children[1].insertBefore(e.setNode({tag:"param",attr:{"name":"wmode","value":"opaque"}}),h.children[1].children[0]);h.children[1].lastChild.setAttribute("wmode","opaque")}m.appendChild(h);f.removeChild(f.children[c]);delete h}break;case"text":if(f.children[c].innerHTML==""&&f.children[c].tagName.toLowerCase()!="div"){f.removeChild(f.children[c]);c--;g--;continue}if(i&&f.children[c].tagName.toLowerCase()!="div"){h=f.children[c].cloneNode(true);h=e.setNode({tag:"div",attr:{"role":"text","style":"position:absolute;top:"+currentNode2.children[c].offsetTop+"px;left:"+currentNode2.children[c].offsetLeft+"px;"}}).appendChild(h).parentNode;if(m.children.length==1)m.appendChild(h);else m.insertBefore(h,m.children[c]);m.removeChild(m.children[c+1]);delete h}b.push(f.children[c]);d.push(currentNode2.children[c]);default:break}}if(i)i=false}a.innerHTML=m.innerHTML;return true}this.autoHeight();this.normalizeTree(t[0])}var z=function(b,d,c){var g=e.setNode({attr:{"class":"jerboa-button jerboa-ignore "+((c)?c:"")},html:b,event:{add:"click",fn:function(a){n.notify("click-button-"+d,a)}}});this.name=d;this.getValue=function(){return b};this.setValue=function(a){e.setNode(g,{html:a})};this.getElement=function(){return g}}var F=function(b,d){var c=e.setNode({attr:{"class":"flipswitch jerboa-ignore"}}),g=e.setNode({attr:{"class":"jerboa-button jerboa-ignore"}}),f=e.setNode({attr:{"class":"hide"},html:"on"}),i=e.setNode({html:"off"}),h=e.setNode({tag:"label",attr:{"class":"jerboa-ignore"},html:b}),m=false;c.appendChild(h);c.appendChild(g);g.appendChild(f);g.appendChild(i);this.name=b;this.toggle=function(a){if(a){e.getEvent(a).preventDefault()}if(m){m=false;e.removeClass(i,"hide");e.addClass(f,"hide")}else{m=true;e.removeClass(f,"hide");e.addClass(i,"hide")}n.notify("click-flipswitch-"+b,m)}this.getElement=function(){return c}this.getValue=function(){return m}this.setValue=function(a){if(m!=a){this.toggle()}}e.setNode(g,{event:{add:"mousedown",fn:e.curry(this.toggle,this)}})}var N=function(a){var b=e.setNode({attr:{"class":"hline "+((a)?a:"")}});this.name="hline"+Date();this.getElement=function(){return b}}var O=function(b,d,c){var g=e.setNode(),f=e.setNode({tag:"input",attr:{"value":(d)?d:"","type":"text","class":(c)?c:""}}),i=e.setNode({tag:"label",html:b});g.appendChild(i);g.appendChild(f);this.name=b this.setClass=function(a){e.setNode(f,{attr:{"class":a}})}this.getValue=function(){return f.value}this.setValue=function(a){f.value=a}this.getElement=function(){return g}}var P=function(b,d,c){var g=e.setNode(),f=e.setNode({tag:"textarea",attr:{"class":(c)?c:""},html:(d)?d:""}),i=e.setNode({tag:"label",html:b});g.appendChild(i);g.appendChild(f);this.name=b this.setClass=function(a){e.setNode(f,{attr:{"class":a}})}this.getValue=function(){return f.innerHTML}this.setValue=function(a){f.innerHTML=a}this.getElement=function(){return g}}var Q=function(c){var g,c=c.toLowerCase(),f={},i=[];if(C[c]){throw new Error("Module "+c+" have been used.");}g=e.setNode({attr:{id:"jerboa-"+c,"class":"hide"}});this.name=c;this.add=function(a){if(a.name){f[a.name]=a;if(a.getValue)i.push(a.name);g.appendChild(a.getElement());return a}}this.remove=function(a){if(f[a])g.removeChild(f[a].getElement())}this.getElement=function(){return g}this.getChild=function(a){if(f[a])return f[a]}this.getValue=function(){var a=[];for(var b=0,d=i.length;b<d;b++){a.push(f[i[b]].getValue())}return a}this.setValue=function(a){if(a.length!=i.length){throw new Error("MenuItem.setValue --> array size("+a.length+") is not equal number of fields("+i.length+").");}for(var b=0,d=a.length;b<d;b++){f[i[b]].setValue(a[b])}}}var R=function(){var d=e.setNode({attr:{id:"jerboa-menubox","style":"left:0;top:0;","class":"jerboa-ignore hide"}}),c={},g=d.appendChild(e.setNode({attr:{"class":"balloon"}})),f="";this.setX=function(a){e.addStyle(d,{"left":a+"px"})}this.setXBalloon=function(a){e.addStyle(g,{"margin-left":a+"px"})}this.add=function(a){A(a,S);c[a.name]=a;d.appendChild(a.getElement())}this.show=function(a){if(!c[a]){throw new Error("Can not find "+a+" in MenuItem");}if(e.hasClass(d,"hide"))e.removeClass(d,"hide");if(e.hasClass(c[a].getElement(),"hide"))e.removeClass(c[a].getElement(),"hide");f=a}this.hide=function(a){if(!c[a]){throw new Error("Can not find "+a+" in MenuItem");}if(f){if(!e.hasClass(c[f].getElement(),"hide"))e.addClass(c[f].getElement(),"hide");if(!e.hasClass(d,"hide"))e.addClass(d,"hide");f=""}}this.toggle=function(a,b){if(b){this.setX(b.left-13);this.setXBalloon((b.width/2)+3)}if(f==a)this.hide(a);else this.show(a)}this.getChild=function(a){if(c[a])return c[nameMEnuItem]}this.getElement=function(){return d}}var T=new x("Library",["onDomReady","addEvent","removeEvent","getEvent","addClass","removeClass","hasClass","addStyle","removeStyle","setNode","curry","request"]),U=new x("Module",["init","destroy","enable"]),S=new x("MenuItem",["add","remove","getValue","setValue","getElement","name"]),Y=new x("UI",["getValue","setValue","name"]);A(l.lib,T);var e=l.lib;delete l.lib;var V=l.path;delete l.path;var C={},k={menubar:new E()},q={},j=null,s={},n=new(function(){var f={};this.lib=e;this.Class=function(a){return eval(a)}this.ui=function(a){return k[a]}this.addPanel=function(a){var b=new B(a);k.wrapper.appendChild(b.getElement());return b}this.addMenu=function(a){var b=new K(a);k.menubar.add(b);return b}this.notify=function(a,b){var d=a.split("-"),c,g;d={"event":d[0]||"","ui":d[1]||"","name":d[2]||"","data":b}if(f[a]){for(var c=0,g=f[a].length;c<g;c++){f[a][c](d)}}if(f[d.event+"-"+d.ui]){for(var c=0,g=f[d.event+"-"+d.ui].length;c<g;c++){f[d.event+"-"+d.ui][c](d)}}if(f[d.event]){for(var c=0,g=f[d.event].length;c<g;c++){f[d.event][c](d)}}console.log(a)}this.listen=function(a,b,d){if(typeof a==="string"){if(!f[a])f[a]=[];f[a].push(e.curry(b,d))}for(var c=0,g=a.length;c<g;c++){if(!f[a[c]]){f[a[c]]=[]}f[a[c]].push(e.curry(b,d))}}this.hasModule=function(a){if(q[a])return true;return false}});l.version=0.001;l.register=function(a,b){var d=new b(n);A(d,U);if(q[a]){throw new Error("Duplicate Module: "+a);}q[a]=d;if(k.option){var c=new F(a);c.setValue(q[a].enable);k.option.add(c);q[a].init()}};for(var w in l.tempRegister){l.register.apply(null,l.tempRegister[w])}delete l.tempRegister;var Z=function(a){if(!q[a]){throw new Error("Not Found "+a+" Module");}q[a].init()};var ba=function(a){if(!q[a]){throw new Error("Not found "+a+" Module");}q[a].destroy()};l.apply=function(a){var b;if(!(b=document.getElementById(a)))return false;j=b;W()};var u=function(a){var b=s,d=e.getEvent(a),c=1;if(j.currentState!="textedit")d.preventDefault();if(a.type=="mousedown"){if(j.currentState!="textedit"||(a.shiftKey)){d.preventDefault();b.x=a.pageX;b.y=a.pageY;e.addEvent(document,"mousemove",u);e.addEvent(document,"mouseup",u)}}else if(a.type=="mousemove"){if(a.shiftKey){b.root_w+=a.pageX-b.x;b.root_h+=a.pageY-b.y}else if(/move$/i.test(j.currentState)){b.root_left+=a.pageX-b.x;b.root_top+=a.pageY-b.y}if(b.root_top+b.root_h+2*c>b.screen_h){if(a.shiftKey)b.root_h=b.screen_h-b.root_top-(2*c);else b.root_top-=a.pageY-b.y}else if(b.root_top<0)b.root_top-=a.pageY-b.y;if(b.root_left+b.root_w+2*c>b.screen_w){if(a.shiftKey)b.root_w=b.screen_w-b.root_left-(2*c);else b.root_left-=a.pageX-b.x}else if(b.root_left<0)b.root_left-=a.pageX-b.x;if(a.shiftKey){e.addStyle(j.currentEditingNode,{width:b.root_w+"px",height:b.root_h+"px"});if(/^image/i.test(j.currentState))e.addStyle(j.currentEditingNode.children[0],{width:b.root_w+"px",height:b.root_h+"px"});else if(/^media/i.test(j.currentState)&&j.currentEditingNode.children.length==2){e.addStyle(j.currentEditingNode.children[1],{width:b.root_w+"px",height:b.root_h+"px"});e.addStyle(j.currentEditingNode.children[1].getElementsByTagName("embed")[0],{width:b.root_w+"px",height:b.root_h+"px"})}}else if(/move$/i.test(j.currentState))e.addStyle(j.currentEditingNode,{top:b.root_top+"px",left:b.root_left+"px"});b.x=a.pageX;b.y=a.pageY}else if(a.type=="mouseup"){e.removeEvent(document,"mousemove",u);e.removeEvent(document,"mouseup",u)}}var v=function(){if(!j.currentState)return false;e.removeClass(j.currentEditingNode,"jerboa-touch");e.removeEvent(j.currentEditingNode,"mousedown",u);switch(j.currentState){case"textmove":break;case"textedit":j.currentEditingNode.setAttribute("contenteditable","false");break;case"imagemove":break;case"imageedit":break;default:break}j.currentEditingNode=null;j.currentState="";n.notify("restorestate")}var G=function(a){var b=e.getEvent(a),d="",c=null;if(j.currentState=="textedit"){if(e.hasClass(b.target,"jerboa-ignore"))v()}b.preventDefault();if(!e.hasClass(b.target,"jerboa-ignore")){d=e.detectMedia(b.target);var g=b.target;while(!e.hasClass(g.parentNode,"jerboa-ignore")){g=g.parentNode}if(!g.parentNode.getAttribute("index"))return false;if(j.currentEditingNode==g)return false;if(j.currentEditingNode!=null)v();j.currentEditingNode=g;e.addClass(g,"jerboa-touch");e.addEvent(g,"mousedown",u);j.currentState=d+"move";n.notify(d+"move");c=j.getElement();s.screen_top=c.offsetTop;s.screen_left=c.offsetLeft;s.screen_w=c.offsetWidth;s.screen_h=c.offsetHeight;s.root_top=g.offsetTop;s.root_left=g.offsetLeft;s.root_w=g.offsetWidth;s.root_h=g.offsetHeight;return false}v()}var H=function(a){var b=e.getEvent(a)b.preventDefault();if(!e.hasClass(b.target,"jerboa-ignore")){switch(e.detectMedia(b.target)){case"text":var d=b.target;while(!e.hasClass(d.parentNode,"jerboa-ignore")){d=d.parentNode}if(!d.parentNode.getAttribute("index"))return false;if(j.currentEditingNode==d&&j.currentState=="textedit")return false;if(j.currentEditingNode!=null)v();j.currentEditingNode=d;e.addClass(d,"jerboa-touch");e.addEvent(d,"mousedown",u);d.setAttribute("contenteditable","true");d.focus();j.currentState="textedit";n.notify("textedit");return false;break;case"image":break;default:break}}}var I=function(a){var b=e.getEvent(a);if(a.ctrlKey&&a.keyCode==86&&!(/edit$/i.test(j.currentState))){n.notify("keydown-noediting-paste",a)}if((a.keyCode==8||a.keyCode==46)&&/move$/i.test(j.currentState)){j.getLayer().removeChild(j.currentEditingNode);v()}}var W=function(){var d=document.createDocumentFragment(),c;k.core=e.setNode({attr:{id:"jerboa"}});k.wrapper=e.setNode({attr:{id:"jerboa-wrapper"}});k.core.appendChild(k.wrapper);j=new L(j,k);k.wrapper.appendChild(k.menubar.getElement());n.addMenu("option");k.menuitem=new R();k.option=new Q("option");k.option.add(new O("Page Height <span>enter Height which you want</span>",j.getElement().offsetHeight,"bigger last"));k.option.add(new P("Custom <b>CSS</b>",""));k.option.add(new z("ok","optionok","right"));k.option.add(new N("last"));n.listen(["click-button-optionok"],function(){var a=k.option.getValue()[0];j.setHeight(a)},l);k.menuitem.add(k.option);k.wrapper.appendChild(k.menuitem.getElement());n.listen(["click-menu"],function(a){var b=e.getEvent(a.data);b={"width":b.target.offsetWidth,"left":b.target.offsetLeft};this.toggle(a.name,b);v()},k.menuitem);c=k.menubar.getElement().appendChild(e.setNode());k.loader=e.setNode({tag:"span",attr:{"class":"hide","style":"float:left;padding:0 30px;line-height:40px;"},html:"<img src=\""+V+"/img/loader.gif\" \/>"});c.appendChild(k.loader);c.appendChild(new z("save","endsave").getElement());c.appendChild(new z("save&close","endsaveclose").getElement());c.appendChild(new z("close","endclose").getElement());n.listen(["click-button-endsave","click-button-endsaveclose"],function(){l.save(n)},l);n.listen(["click-button-endsaveclose","click-button-endclose"],function(){X()});e.addEvent(document,"click",G);e.addEvent(document,"dblclick",H);e.addEvent(document,"keydown",I);for(var g in q){var c=new F(g);c.setValue(q[g].enable);k.option.add(c);q[g].init()}d.appendChild(k.core);document.body.appendChild(d)};var X=function(){document.body.removeChild(k.core);for(w=0,len=document.styleSheets.length;w<len;w++){if(/jerboa\.css/i.test(document.styleSheets[w].href)){document.getElementsByTagName("head")[0].removeChild(document.styleSheets[w].ownerNode);break}}v();e.removeEvent(document,"click",G);e.removeEvent(document,"dblclick",H);e.removeEvent(document,"keydown",I)};if(l.tempApply)l.apply(l.tempApply);delete l.tempApply;return l}(Jerboa||{}));if(document.body)Jerboa.apply("test_edit");