Jerboa.register("FancyInsert",function(b){var e=b.lib;var h=function(){var a=e.setNode({attr:{"contenteditable":"true","style":"display:inline-block;overflow:hidden;width:1px;height:1px;"}});this.getElement=function(){return a}this.getValue=function(){a.blur();return a.innerHTML}this.setValue=function(c){a.innerHTML=c}this.focus=function(){a.innerHTML="";a.focus()}}var f=new h();this.enable=true;this.sendDecorateNode=function(c){if(!this.enable)return;var a="",g,i={"png":1,"jpg":1,"gif":1};if(c){a=c.replace(/\<meta[^\>]+\>/i,"");if(/\<span[^\>]*Apple-style-span[^\>]+\>/i.test(a))a=a.replace(/\<span[^\>]*Apple-style-span[^\>]+\>/i,"").replace(/\<\/span\>$/i,"");if(/^\<a href="([^\>]+)"\>\1\<\/a\>$/i.test(a)){a=a.replace(/^\<a href="([^\>]+)"\>/i,"").replace(/\<\/a\>$/i,"");if(/^http/i.test(a)){var d=a.split(".");d=d[d.length-1];if(i[d])a="<img src=\""+a+"\" />"}}if(/^\&lt;object/i.test(a)){a=a.replace(/&lt;/ig,"<").replace(/&gt;/ig,">");a=a.replace(/\>\<param/i,"><param wmode=\"opaque\"><param");a=a.replace(/\<embed/i,"<embed wmode=\"opaque\"");console.log(a)}}else{a="Insert Text here"}g=e.detectMedia(a);if(g=="media")a="<div class=\"jerboa-media-touch\"> </div>"+a;var j=e.setNode({html:a,attr:{"role":g,"style":"position:absolute;top:0px;left:0px;"}});b.Class("stage").getLayer().appendChild(j)}this.init=function(){var a=this;b.ui("core").appendChild(f.getElement());b.listen(["keydown-noediting-paste"],function(){f.focus();setTimeout(function(){a.sendDecorateNode(f.getValue())},100)},this);b.listen(["click-flipswitch-FancyInsert"],function(c){this.enable=c.data},this)};this.destroy=function(){b.ui("core").removeChild(childboard.getElement())}});